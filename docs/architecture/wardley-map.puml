@startuml
title Wardley Map - Shopping System

skinparam componentStyle rectangle
skinparam packageStyle rectangle
skinparam linetype ortho

package "Genesis (Innovation)" #LightBlue {
    component [Personalized Experience\nAdvanced Experiments] as personalized_experience
    component [Propensity Models\nML Experiments] as propensity_models
    component [Recommender Models\nDL Experiments] as recommender_models
}

package "Custom-built" #LightGreen {
    component [Product Management\nDomain Service] as product_mgmt
    component [Cart Management\nDomain Service] as cart_mgmt
    component [Order Management\nDomain Service] as order_mgmt
    component [User Management\nDomain Service] as user_mgmt
    component [Payment Service\nOrchestration] as payment_service
    component [Recommendation Service\nTF-IDF] as recommendation_service
    component [Crawler Service] as crawler_service
    component [Data Mining Jobs] as data_mining_jobs
    component [Auth Service\nJWT and OAuth] as auth_service
    component [API Service\nExpress and Lambda] as api_service
    component [Meeting Signal Service\nWebRTC Signaling] as meeting_signal_service
}

package "Product" #LightYellow {
    component [Web Application\nNext.js] as web_app
    component [Mobile Application\nReact Native] as mobile_app
    component [Admin Dashboard\nAngular] as admin_app
    component [MongoDB\nDocument Database] as mongodb
    component [Vercel\nHosting and Edge] as vercel
    component [AWS Lambda\nServerless Compute] as aws_lambda
    component [Datadog\nAPM and RUM] as datadog
    component [Serverless Framework\nDeployment] as serverless_framework
    component [Socket.io\nRealtime] as socket_io
    component [Shared Libraries\nAuth, Monitoring, Utils, Types] as shared_libs
}

package "Commodity" #LightGray {
    component [Node.js Runtime] as nodejs
    component [TypeScript] as typescript
    component [HTTP Protocol] as http
    component [CDN Service] as cdn
    component [CI/CD Service\nGitHub Actions] as cicd
    component [Git Repository] as git
}

component [User Needs\nShopping, Account Management] as user_needs #Pink
component [Admin Needs\nOperations and Monitoring] as admin_needs #Pink

component [Payment Gateways\nAlipay, WeChat Pay, Stripe] as payment_gateways
component [OAuth Providers\nGoogle, GitHub, Others] as oauth_providers
component [External Websites\nProduct Sources] as external_websites

user_needs --> web_app : via web
user_needs --> mobile_app : via mobile
admin_needs --> admin_app : via browser

web_app --> api_service : calls API
mobile_app --> api_service : calls API
admin_app --> api_service : calls API
admin_app --> crawler_service : manages crawling
admin_app --> meeting_signal_service : manages meetings

api_service --> product_mgmt
api_service --> cart_mgmt
api_service --> order_mgmt
api_service --> user_mgmt
api_service --> payment_service
api_service --> recommendation_service
api_service --> auth_service

product_mgmt --> mongodb
cart_mgmt --> mongodb
order_mgmt --> mongodb
user_mgmt --> mongodb

recommendation_service --> mongodb
recommendation_service --> personalized_experience
recommendation_service --> propensity_models
recommendation_service --> recommender_models

data_mining_jobs --> mongodb
data_mining_jobs --> propensity_models
data_mining_jobs --> recommender_models

crawler_service --> external_websites
crawler_service --> data_mining_jobs

meeting_signal_service --> socket_io

payment_service --> payment_gateways
auth_service --> oauth_providers

api_service --> aws_lambda
api_service --> nodejs
api_service --> http

web_app --> vercel
mobile_app --> vercel
admin_app --> vercel

vercel --> cdn
web_app --> cdn
mobile_app --> cdn
admin_app --> cdn

web_app --> shared_libs
mobile_app --> shared_libs
admin_app --> shared_libs
api_service --> shared_libs

web_app --> typescript
mobile_app --> typescript
admin_app --> typescript
api_service --> typescript

web_app --> datadog
mobile_app --> datadog
admin_app --> datadog
api_service --> datadog
aws_lambda --> datadog

serverless_framework --> aws_lambda
cicd --> serverless_framework
cicd --> vercel
git --> cicd

@enduml

